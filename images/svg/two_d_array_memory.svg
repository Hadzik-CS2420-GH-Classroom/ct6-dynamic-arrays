<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 860 720" font-family="Consolas, 'Courier New', monospace" font-size="14">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#569cd6"/>
    </marker>
    <marker id="arrow-green" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4ec9b0"/>
    </marker>
    <marker id="arrow-amber" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#dcdcaa"/>
    </marker>
    <marker id="arrow-pink" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#c586c0"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="860" height="720" fill="#1e1e1e" rx="8"/>

  <!-- Title -->
  <text x="430" y="35" text-anchor="middle" fill="#569cd6" font-size="18" font-weight="bold">2D Array Memory Layout — Pointer-to-Pointer vs Flat</text>

  <!-- ============================================================ -->
  <!-- APPROACH 1: Pointer-to-Pointer  (int** table)                -->
  <!-- ============================================================ -->
  <text x="30" y="72" fill="#c586c0" font-size="15" font-weight="bold">Approach 1: int** table — Pointer-to-Pointer</text>
  <text x="30" y="92" fill="#608b4e" font-size="12">int** table = new int*[rows];   // rows = 3, cols = 4</text>

  <!-- STACK label -->
  <text x="30" y="122" fill="#569cd6" font-size="11" font-weight="bold">STACK</text>
  <line x1="30" y1="126" x2="130" y2="126" stroke="#569cd6" stroke-width="1" stroke-dasharray="3,2"/>

  <!-- table variable on stack -->
  <rect x="30" y="134" width="100" height="45" rx="6" fill="#2d2d2d" stroke="#c586c0" stroke-width="2"/>
  <text x="80" y="153" text-anchor="middle" fill="#c586c0" font-size="11" font-weight="bold">int**</text>
  <text x="80" y="170" text-anchor="middle" fill="#9cdcfe" font-size="12">table</text>

  <!-- Arrow from table to spine -->
  <line x1="130" y1="156" x2="195" y2="156" stroke="#c586c0" stroke-width="2" marker-end="url(#arrow-pink)"/>

  <!-- HEAP label -->
  <text x="205" y="122" fill="#4ec9b0" font-size="11" font-weight="bold">HEAP</text>
  <line x1="205" y1="126" x2="820" y2="126" stroke="#4ec9b0" stroke-width="1" stroke-dasharray="3,2"/>

  <!-- Spine: array of 3 int* pointers -->
  <rect x="205" y="134" width="110" height="140" rx="6" fill="#2d2d2d" stroke="#569cd6" stroke-width="2"/>
  <text x="260" y="128" text-anchor="middle" fill="#569cd6" font-size="10">Spine (int*[3])</text>

  <!-- table[0] -->
  <rect x="215" y="143" width="90" height="32" rx="4" fill="#1e1e1e" stroke="#569cd6" stroke-width="1.5"/>
  <text x="260" y="164" text-anchor="middle" fill="#9cdcfe" font-size="11">table[0]</text>

  <!-- table[1] -->
  <rect x="215" y="183" width="90" height="32" rx="4" fill="#1e1e1e" stroke="#dcdcaa" stroke-width="1.5"/>
  <text x="260" y="204" text-anchor="middle" fill="#9cdcfe" font-size="11">table[1]</text>

  <!-- table[2] -->
  <rect x="215" y="223" width="90" height="32" rx="4" fill="#1e1e1e" stroke="#4ec9b0" stroke-width="1.5"/>
  <text x="260" y="244" text-anchor="middle" fill="#9cdcfe" font-size="11">table[2]</text>

  <!-- ========== ROW 0 ========== -->
  <!-- Arrow from table[0] to row 0 -->
  <line x1="305" y1="159" x2="390" y2="159" stroke="#569cd6" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Row 0 array -->
  <rect x="400" y="140" width="380" height="38" rx="4" fill="#2d2d2d" stroke="#569cd6" stroke-width="1.5"/>
  <text x="590" y="133" text-anchor="middle" fill="#569cd6" font-size="10">Row 0: new int[4]</text>

  <rect x="410" y="148" width="80" height="24" rx="3" fill="#1e1e1e" stroke="#569cd655" stroke-width="1"/>
  <text x="450" y="164" text-anchor="middle" fill="#b5cea8" font-size="13" font-weight="bold">1</text>

  <rect x="496" y="148" width="80" height="24" rx="3" fill="#1e1e1e" stroke="#569cd655" stroke-width="1"/>
  <text x="536" y="164" text-anchor="middle" fill="#b5cea8" font-size="13" font-weight="bold">2</text>

  <rect x="582" y="148" width="80" height="24" rx="3" fill="#1e1e1e" stroke="#569cd655" stroke-width="1"/>
  <text x="622" y="164" text-anchor="middle" fill="#b5cea8" font-size="13" font-weight="bold">3</text>

  <rect x="668" y="148" width="80" height="24" rx="3" fill="#1e1e1e" stroke="#569cd655" stroke-width="1"/>
  <text x="708" y="164" text-anchor="middle" fill="#b5cea8" font-size="13" font-weight="bold">4</text>

  <!-- Index labels for row 0 -->
  <text x="450" y="186" text-anchor="middle" fill="#555" font-size="9">[0][0]</text>
  <text x="536" y="186" text-anchor="middle" fill="#555" font-size="9">[0][1]</text>
  <text x="622" y="186" text-anchor="middle" fill="#555" font-size="9">[0][2]</text>
  <text x="708" y="186" text-anchor="middle" fill="#555" font-size="9">[0][3]</text>

  <!-- ========== ROW 1 ========== -->
  <!-- Arrow from table[1] to row 1 -->
  <line x1="305" y1="199" x2="390" y2="220" stroke="#dcdcaa" stroke-width="2" marker-end="url(#arrow-amber)"/>

  <!-- Row 1 array -->
  <rect x="400" y="202" width="380" height="38" rx="4" fill="#2d2d2d" stroke="#dcdcaa" stroke-width="1.5"/>
  <text x="590" y="252" text-anchor="middle" fill="#dcdcaa" font-size="10">Row 1: new int[4]</text>

  <rect x="410" y="210" width="80" height="24" rx="3" fill="#1e1e1e" stroke="#dcdcaa55" stroke-width="1"/>
  <text x="450" y="226" text-anchor="middle" fill="#b5cea8" font-size="13" font-weight="bold">5</text>

  <rect x="496" y="210" width="80" height="24" rx="3" fill="#1e1e1e" stroke="#dcdcaa55" stroke-width="1"/>
  <text x="536" y="226" text-anchor="middle" fill="#b5cea8" font-size="13" font-weight="bold">6</text>

  <rect x="582" y="210" width="80" height="24" rx="3" fill="#1e1e1e" stroke="#dcdcaa55" stroke-width="1"/>
  <text x="622" y="226" text-anchor="middle" fill="#b5cea8" font-size="13" font-weight="bold">7</text>

  <rect x="668" y="210" width="80" height="24" rx="3" fill="#1e1e1e" stroke="#dcdcaa55" stroke-width="1"/>
  <text x="708" y="226" text-anchor="middle" fill="#b5cea8" font-size="13" font-weight="bold">8</text>

  <!-- ========== ROW 2 ========== -->
  <!-- Arrow from table[2] to row 2 -->
  <line x1="305" y1="239" x2="390" y2="284" stroke="#4ec9b0" stroke-width="2" marker-end="url(#arrow-green)"/>

  <!-- Row 2 array -->
  <rect x="400" y="266" width="380" height="38" rx="4" fill="#2d2d2d" stroke="#4ec9b0" stroke-width="1.5"/>
  <text x="590" y="316" text-anchor="middle" fill="#4ec9b0" font-size="10">Row 2: new int[4]</text>

  <rect x="410" y="274" width="80" height="24" rx="3" fill="#1e1e1e" stroke="#4ec9b055" stroke-width="1"/>
  <text x="450" y="290" text-anchor="middle" fill="#b5cea8" font-size="13" font-weight="bold">9</text>

  <rect x="496" y="274" width="80" height="24" rx="3" fill="#1e1e1e" stroke="#4ec9b055" stroke-width="1"/>
  <text x="536" y="290" text-anchor="middle" fill="#b5cea8" font-size="13" font-weight="bold">10</text>

  <rect x="582" y="274" width="80" height="24" rx="3" fill="#1e1e1e" stroke="#4ec9b055" stroke-width="1"/>
  <text x="622" y="290" text-anchor="middle" fill="#b5cea8" font-size="13" font-weight="bold">11</text>

  <rect x="668" y="274" width="80" height="24" rx="3" fill="#1e1e1e" stroke="#4ec9b055" stroke-width="1"/>
  <text x="708" y="290" text-anchor="middle" fill="#b5cea8" font-size="13" font-weight="bold">12</text>

  <!-- Allocation count callout -->
  <rect x="30" y="200" width="155" height="80" rx="6" fill="#dc354510" stroke="#dc3545" stroke-width="1.5" stroke-dasharray="4,2"/>
  <text x="40" y="220" fill="#dc3545" font-size="11" font-weight="bold">4 allocations:</text>
  <text x="40" y="236" fill="#d4d4d4" font-size="10">1 spine  (int*[3])</text>
  <text x="40" y="250" fill="#d4d4d4" font-size="10">3 rows   (int[4] each)</text>
  <text x="40" y="268" fill="#dc3545" font-size="10" font-weight="bold">4 calls to delete[]!</text>

  <!-- Separation line -->
  <line x1="30" y1="340" x2="830" y2="340" stroke="#555" stroke-width="1" stroke-dasharray="6,3"/>

  <!-- ============================================================ -->
  <!-- DELETE ORDER                                                  -->
  <!-- ============================================================ -->
  <text x="30" y="370" fill="#dc3545" font-size="15" font-weight="bold">Freeing: rows first, then spine (reverse order!)</text>

  <!-- Step 1: Delete rows -->
  <rect x="30" y="385" width="390" height="55" rx="4" fill="#2d2d2d" stroke="#555" stroke-width="1"/>
  <text x="45" y="405" fill="#d7ba7d" font-size="12">for (int i = 0; i &lt; rows; ++i)</text>
  <text x="45" y="425" fill="#d7ba7d" font-size="12">    delete[] table[i];  <tspan fill="#6a9955">// free each row</tspan></text>

  <!-- Arrow -->
  <text x="435" y="415" fill="#569cd6" font-size="14">→</text>

  <!-- Step 2: Delete spine -->
  <rect x="460" y="385" width="370" height="55" rx="4" fill="#2d2d2d" stroke="#555" stroke-width="1"/>
  <text x="475" y="405" fill="#d7ba7d" font-size="12">delete[] table;       <tspan fill="#6a9955">// free spine</tspan></text>
  <text x="475" y="425" fill="#d7ba7d" font-size="12">table = nullptr;      <tspan fill="#6a9955">// safety</tspan></text>

  <!-- Warning callout -->
  <rect x="460" y="448" width="370" height="28" rx="4" fill="#dc354510" stroke="#dc3545" stroke-width="1"/>
  <text x="475" y="467" fill="#dc3545" font-size="11">⚠ Delete spine first → row pointers lost → LEAK!</text>

  <!-- Separation line -->
  <line x1="30" y1="495" x2="830" y2="495" stroke="#555" stroke-width="1" stroke-dasharray="6,3"/>

  <!-- ============================================================ -->
  <!-- APPROACH 2: Flat array  (int* flat)                          -->
  <!-- ============================================================ -->
  <text x="30" y="528" fill="#28a745" font-size="15" font-weight="bold">Approach 2: int* flat — Single Contiguous Block</text>
  <text x="30" y="548" fill="#608b4e" font-size="12">int* flat = new int[rows * cols];   // 3 * 4 = 12 ints</text>

  <!-- STACK label -->
  <text x="30" y="578" fill="#569cd6" font-size="11" font-weight="bold">STACK</text>
  <line x1="30" y1="582" x2="130" y2="582" stroke="#569cd6" stroke-width="1" stroke-dasharray="3,2"/>

  <!-- flat variable on stack -->
  <rect x="30" y="590" width="100" height="45" rx="6" fill="#2d2d2d" stroke="#28a745" stroke-width="2"/>
  <text x="80" y="609" text-anchor="middle" fill="#28a745" font-size="11" font-weight="bold">int*</text>
  <text x="80" y="626" text-anchor="middle" fill="#9cdcfe" font-size="12">flat</text>

  <!-- Arrow from flat to heap block -->
  <line x1="130" y1="612" x2="195" y2="612" stroke="#28a745" stroke-width="2" marker-end="url(#arrow-green)"/>

  <!-- HEAP label -->
  <text x="205" y="578" fill="#4ec9b0" font-size="11" font-weight="bold">HEAP</text>
  <line x1="205" y1="582" x2="820" y2="582" stroke="#4ec9b0" stroke-width="1" stroke-dasharray="3,2"/>

  <!-- Single flat array block -->
  <rect x="205" y="592" width="615" height="44" rx="4" fill="#2d2d2d" stroke="#28a745" stroke-width="1.5"/>

  <!-- Row 0 values -->
  <rect x="212" y="599" width="45" height="30" rx="3" fill="#1e1e1e" stroke="#569cd655" stroke-width="1"/>
  <text x="234" y="618" text-anchor="middle" fill="#b5cea8" font-size="12" font-weight="bold">1</text>

  <rect x="261" y="599" width="45" height="30" rx="3" fill="#1e1e1e" stroke="#569cd655" stroke-width="1"/>
  <text x="283" y="618" text-anchor="middle" fill="#b5cea8" font-size="12" font-weight="bold">2</text>

  <rect x="310" y="599" width="45" height="30" rx="3" fill="#1e1e1e" stroke="#569cd655" stroke-width="1"/>
  <text x="332" y="618" text-anchor="middle" fill="#b5cea8" font-size="12" font-weight="bold">3</text>

  <rect x="359" y="599" width="45" height="30" rx="3" fill="#1e1e1e" stroke="#569cd655" stroke-width="1"/>
  <text x="381" y="618" text-anchor="middle" fill="#b5cea8" font-size="12" font-weight="bold">4</text>

  <!-- Row 1 values -->
  <rect x="410" y="599" width="45" height="30" rx="3" fill="#1e1e1e" stroke="#dcdcaa55" stroke-width="1"/>
  <text x="432" y="618" text-anchor="middle" fill="#b5cea8" font-size="12" font-weight="bold">5</text>

  <rect x="459" y="599" width="45" height="30" rx="3" fill="#1e1e1e" stroke="#dcdcaa55" stroke-width="1"/>
  <text x="481" y="618" text-anchor="middle" fill="#b5cea8" font-size="12" font-weight="bold">6</text>

  <rect x="508" y="599" width="45" height="30" rx="3" fill="#1e1e1e" stroke="#dcdcaa55" stroke-width="1"/>
  <text x="530" y="618" text-anchor="middle" fill="#b5cea8" font-size="12" font-weight="bold">7</text>

  <rect x="557" y="599" width="45" height="30" rx="3" fill="#1e1e1e" stroke="#dcdcaa55" stroke-width="1"/>
  <text x="579" y="618" text-anchor="middle" fill="#b5cea8" font-size="12" font-weight="bold">8</text>

  <!-- Row 2 values -->
  <rect x="608" y="599" width="45" height="30" rx="3" fill="#1e1e1e" stroke="#4ec9b055" stroke-width="1"/>
  <text x="630" y="618" text-anchor="middle" fill="#b5cea8" font-size="12" font-weight="bold">9</text>

  <rect x="657" y="599" width="48" height="30" rx="3" fill="#1e1e1e" stroke="#4ec9b055" stroke-width="1"/>
  <text x="681" y="618" text-anchor="middle" fill="#b5cea8" font-size="12" font-weight="bold">10</text>

  <rect x="709" y="599" width="48" height="30" rx="3" fill="#1e1e1e" stroke="#4ec9b055" stroke-width="1"/>
  <text x="733" y="618" text-anchor="middle" fill="#b5cea8" font-size="12" font-weight="bold">11</text>

  <rect x="761" y="599" width="48" height="30" rx="3" fill="#1e1e1e" stroke="#4ec9b055" stroke-width="1"/>
  <text x="785" y="618" text-anchor="middle" fill="#b5cea8" font-size="12" font-weight="bold">12</text>

  <!-- Row bracket labels -->
  <line x1="212" y1="636" x2="404" y2="636" stroke="#569cd6" stroke-width="1.5"/>
  <text x="308" y="650" text-anchor="middle" fill="#569cd6" font-size="10">Row 0</text>

  <line x1="410" y1="636" x2="602" y2="636" stroke="#dcdcaa" stroke-width="1.5"/>
  <text x="506" y="650" text-anchor="middle" fill="#dcdcaa" font-size="10">Row 1</text>

  <line x1="608" y1="636" x2="809" y2="636" stroke="#4ec9b0" stroke-width="1.5"/>
  <text x="708" y="650" text-anchor="middle" fill="#4ec9b0" font-size="10">Row 2</text>

  <!-- Index formula -->
  <rect x="205" y="658" width="340" height="25" rx="4" fill="#28a74515" stroke="#28a745" stroke-width="1" stroke-dasharray="4,2"/>
  <text x="215" y="675" fill="#28a745" font-size="11">flat[<tspan fill="#9cdcfe">r</tspan> * cols + <tspan fill="#9cdcfe">c</tspan>]  →  flat[<tspan fill="#9cdcfe">1</tspan> * 4 + <tspan fill="#9cdcfe">2</tspan>] = flat[6] = <tspan fill="#b5cea8" font-weight="bold">7</tspan></text>

  <!-- Advantages callout -->
  <rect x="560" y="655" width="260" height="55" rx="6" fill="#28a74515" stroke="#28a745" stroke-width="1.5" stroke-dasharray="4,2"/>
  <text x="570" y="673" fill="#28a745" font-size="11" font-weight="bold">✓ Why flat is usually better:</text>
  <text x="570" y="688" fill="#d4d4d4" font-size="10">• 1 allocation, 1 delete[]</text>
  <text x="570" y="702" fill="#d4d4d4" font-size="10">• Contiguous memory (cache-friendly)</text>
</svg>
